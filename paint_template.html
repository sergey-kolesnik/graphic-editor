<html>
    <head>
        <style>
            .shape, .color {
                height: 25px;
                width: 25px;
                margin: 3px;
            }
            .shape {
                border: none;
            }
            #shape-picker, #color-picker {
                margin: 20px;
            }
            svg, .tools {
                display: inline-block;
                vertical-align: top;
                border: 1px solid black;
            }
            .selected {
                outline: 2px solid red; 
                outline-offset: 3px;;
            }
            #tool-line, #tool-circle, #tool-rectangle {
                background-repeat: no-repeat;
                background-size: contain;
                background-position: center;
            }
            #tool-line {
                background-image: url(Line.png);
            }
            #tool-circle {
                background-image: url(Ellipse.png);
            }
            #tool-rectangle {
                background-image: url(Rectangle.png);
            }
        </style>
    </head>
    <body>
        <svg id="canvas" width="800" height="600" viewBox="0 0 800 600"></svg>
        <div class="tools">
            <div id="shape-picker">
                <button class="shape selected" id="tool-line" data-shape="line"></button>
                <button class="shape" id="tool-circle" data-shape="circle"></button>
                <button class="shape" id="tool-rectangle" data-shape="rectangle"></button>
            </div>
            <div id="color-picker">
                <button class="color selected"  data-color="#000000"></button>
                <button class="color" data-color="#ff0000"></button>
                <button class="color" data-color="#00ff00"></button>
                <button class="color" data-color="#0000ff"></button>
                <button class="color" data-color="#ff00ff"></button>
                <button class="color" data-color="#ffff00"></button>
                <button class="color" data-color="#00ffff"></button>

            </div>
        </div>
        <script>

            let palette = document.getElementById("color-picker");
            let shapePalette = document.getElementById("shape-picker")
            let color = "#000000";

            for (let btn of palette.getElementsByTagName("button")) {
                btn.style.setProperty("background-color", btn.dataset.color)
            }

            palette.addEventListener("click", function(event) {
                let target = event.target;
                let btn = target.closest("button.color");
                if ((btn === undefined) || (btn === null) || (btn.tagName != "BUTTON") || (! palette.contains(btn))) {
                    return
                }
                color = btn.dataset.color;
                palette.querySelector("button.selected").classList.remove("selected");
                btn.classList.add("selected");

            })

            shapePalette.addEventListener("click", function(event) {

                let target = event.target;
                let btn = target.closest("button.shape");
                if ((btn === undefined) || (btn === null) || (btn.tagName != "BUTTON") || (! shapePalette.contains(btn))) {
                    return
                }
                shapeType = btn.dataset.shape;
                shapePalette.querySelector("button.selected").classList.remove("selected");
                btn.classList.add("selected");

            })

            let shapeType = "line";
            let canvas = document.getElementById("canvas");
            let startCoords = {};
           

            let currentShape;
            canvas.addEventListener("mousedown", function(event) {

                startCoords.x = event.pageX;
                startCoords.y = event.pageY;

            })

            let drawLine = function(startCoordinates, endCoordinates) {
                let line = document.createElementNS("http://www.w3.org/2000/svg&quot;", "line");
                line.setAttribute("x1", startCoordinates.x);
                line.setAttribute("y1", startCoordinates.y);
                line.setAttribute("x2", endCoordinates.x);
                line.setAttribute("y2",endCoordinates.y);
                line.setAttribute("stroke", color);
                canvas.appendChild(line);
                return line
            }

            let drawCircle = function(startCoordinates, endCoordinates) {

            }

            let drawRectangle = function(startCoordinates, endCoordinates) {

            }

            let drawShape = function(startCoordinates, endCoordinates) {
                if (shapeType == "line") {
                    return drawLine(startCoordinates, endCoordinates)
                } else if (shapeType == "circle" ){
                    return drawCircle(startCoordinates, endCoordinates)
                } else if (shapeType == "rectangle" ){
                    return drawRectangle(startCoordinates, endCoordinates)
                } else {
                    console.log(`Error ${shapeType} not exist.`)
                }
            }

            canvas.addEventListener("mouseup", function(event) {
                let endCoords = {
                    x: event.pageX,
                    y: event.pageY,
                }

                drawShape(startCoords, endCoords)
            })

            canvas.addEventListener("mousemove", function(event) {
                if (event.buttons == 0) {
                    return;
                }

                let endCoords = {
                    x: event.pageX,
                    y: event.pageY,
                };

                // let xCoord = event.pageX;
                // let yCoord = event.pageY;

                if ((currentShape !== null) && (currentShape !== undefined)) {
                    canvas.removeChild(currentShape);
                }
                let shape = drawShape(startCoords, endCoords)
                // let line = drawLine(startCoords, endCoords);
                currentShape = shape;
            })
        </script>
    </body>
</html>







